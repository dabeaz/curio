language: shell  # 'language: python' does not work on macOS and Windows
cache: pip

matrix:
  include:
    - name: Python 3.7 on Linux
      language: python
      python: 3.7
    - name: Python 3.7 on macOS
      os: osx
      osx_image: xcode11
    - name: Python 3.7 on Windows
      os: windows
      before_install:
        - choco install python3
        - ln -s $(which py) /usr/bin/python3

install:
  - travis_retry python3 -m pip install -e .[test]

script:
  - python3 -m pytest
  - if [[ "$TRAVIS_OS_NAME" != "windows" ]]; then
      sphinx-build -q -b html -b linkcheck -d docs/_build/doctrees docs docs/_build/html ;
    fi
